<div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="false" lang="en-US" style=""><h1 id="HiTree-Efficient-Hierarchical-Speculative-Decoding-via-Tree-Based-Drafting" data-id="HiTree-Efficient-Hierarchical-Speculative-Decoding-via-Tree-Based-Drafting" style=""><span>HiTree: Efficient Hierarchical Speculative Decoding via Tree-Based Drafting</span></h1><p><span>Large Language Models (LLMs) have enabled remarkable progress in diverse domains by delivering high-quality and precise text generation. Despite these advances, the process of text generation remains computationally intensive and time-consuming, posing challenges for efficient and scalable deployment.</span></p><p><span>To overcome these hurdles, innovative techniques like speculative decoding have emerged. This approach leverages a smaller draft model to quickly propose candidate tokens, which are then verified by a larger, more accurate target model.</span></p><p><span>In this blog post, we will explore the fundamental bottlenecks that hinder efficient LLM text generation and introduce the concept of speculative decoding in detail.Additionally, we specifically explore hierarchical approaches to speculative decoding and propose enhancing their performance by transforming into tree-based architectures.</span></p><h2 id="Why-is-LLM-Generation-Inefficient" data-id="Why-is-LLM-Generation-Inefficient" style=""><span>Why is LLM Generation Inefficient?</span></h2><h3 id="LLM-Inference-Phases" data-id="LLM-Inference-Phases" style=""><span>LLM Inference Phases</span></h3><p><span>The LLM inference process is broadly divided into two stages. The first is the prefill stage, where all input tokens are processed in parallel to generate the initial output token. This stage involves a large amount of matrix operations and attention computations, making it computationally intensive. Additionally, the context generated from the attention layers is stored in the key-value (KV) cache and used for subsequent token generation. For these reasons, the prefill stage is considered a computation-bound phase that mainly relies on processing power.</span></p><p><span>The second stage is the decode phase, which begins after the first token is generated. In this phase, tokens are generated autoregressively, with each new token predicted based only on the previously generated token and the KV cache. Because tokens are produced one at a time, parallel processing is not possible, and frequent access to the KV cache places a heavy demand on memory bandwidth and capacity. Therefore, the decode phase is characterized as a memory-bound stage, where memory access becomes the main bottleneck rather than computation.</span></p><h3 id="Bottlenecks-in-LLM-Inference" data-id="Bottlenecks-in-LLM-Inference" style=""><span>Bottlenecks in LLM Inference</span></h3><p><span>From a system perspective, most of the latency in LLM inference is known to occur during the decode phase</span><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup><span>. In other words, the primary bottleneck arises from the accelerator’s memory bandwidth limitations rather than arithmetic computations. This is due to the sequential nature of auto-regressive decoding, where each forward pass requires transferring the entire model parameters from High-Bandwidth Memory (HBM) to the accelerator’s cache. Because tokens are generated one at a time, the high computational capabilities of modern accelerators are underutilized, leading to inefficiencies.</span></p><p><span>This inefficiency is clearly reflected in cost structures as well. As of September 2023, the generation cost for GPT-4 is approximately twice that of simple prompt processing, while for Claude 2, it is about three times higher. The need for improvement in the decoding phase is clearly evident, and speculative decoding has been gaining attention as a promising technique to address this.</span></p><div style="text-align: center;">
  <span class="image-toolbar-wrapper inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" style="width: 600px;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="https://hackmd.io/_uploads/SJZOS3Sfgg.jpg" alt="per token price" width="600" class="offline-handled error-handled image-toolbar-handled" style="width: 100%; height: 100%; max-width: 100%; max-height: 100%;"></span>
  <p style="font-size: 0.9em; color: gray;">
    Figure 1: Per token price comparison of GPT-4 and Claude 2 
    [<a href="https://x.com/mattshumer_/status/1699093734330183937" target="_blank">source</a>].
  </p>
</div><h2 id="How-Does-Speculative-Decoding-Work" data-id="How-Does-Speculative-Decoding-Work" style=""><span>How Does Speculative Decoding Work?</span></h2><p><span>Speculative decoding is an effective technique developed to accelerate LLMs inference, especially during the decode phase</span><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup><span>. It uses a smaller auxiliary model called the draft model. This draft model is compact and fast, enabling it to quickly propose multiple candidate tokens. Although it operates autoregressively, the draft model significantly reduces latency.</span></p><p><span>Next, the target model (the original model) verifies these candidate tokens in parallel. During this verification, the target model decides whether to accept or reject each draft token. Accepted tokens are immediately appended to the output sequence, significantly speeding up inference. If any tokens are rejected, the target model recomputes the next token sequentially to ensure output quality. By accepting multiple candidate tokens generated by the draft model in a single inference step, the target model effectively reduces the overall latency.</span></p><p><span>It is crucial to maintain the target model’s performance when candidate tokens from the draft model are accepted. To achieve this, a technique called Speculative Sampling has been proposed. It has been proven that this method theoretically ensures the generated tokens precisely follow the distribution of the target model. Below is the Speculative Sampling algorithm.</span></p><hr><blockquote>
<p><span class="mathjax raw code-block-wrapper code-block-toolbar-handled" data-raw-code="XHRleHRiZntBbGdvcml0aG0gMSB9" style="margin-bottom: 0px;"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-edit-from-here-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-map-pin-simple" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><span class="ml-1 border-0 border-l border-solid border-background-subtle pr-1" aria-hidden="true"></span><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="40" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-b"><mjx-c class="mjx-c1D400 TEX-B"></mjx-c><mjx-c class="mjx-c1D425 TEX-B"></mjx-c><mjx-c class="mjx-c1D420 TEX-B"></mjx-c><mjx-c class="mjx-c1D428 TEX-B"></mjx-c><mjx-c class="mjx-c1D42B TEX-B"></mjx-c><mjx-c class="mjx-c1D422 TEX-B"></mjx-c><mjx-c class="mjx-c1D42D TEX-B"></mjx-c><mjx-c class="mjx-c1D421 TEX-B"></mjx-c><mjx-c class="mjx-c1D426 TEX-B"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c1D7CF TEX-B"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext mathvariant="bold">Algorithm 1&nbsp;</mtext></math></mjx-assistive-mml></mjx-container></span><span> Speculative Decoding</span></p>
</blockquote><div style="font-size: 80%; text-align: left;">
<p><span class="mathjax raw code-block-wrapper code-block-toolbar-handled" data-raw-code="XGJlZ2lue2ZsYWxpZ24qfQomIFx0ZXh0YmZ7SW5wdXRzOiB9IE1fcCwgTV9xLCBcdGV4dHsgcHJlZml4fSAmJiBcXAomIFx0cmlhbmdsZXJpZ2h0IFx0ZXh0e1NhbXBsZSB9IFxnYW1tYSBcdGV4dHsgZ3Vlc3NlcyB9IHhfMSwgXGxkb3RzLCB4X1xnYW1tYSBcdGV4dHsgZnJvbSB9IE1fcSBcdGV4dHsgYXV0b3JlZ3Jlc3NpdmVseS59ICYmIFxcCiYgXHRleHRiZntmb3IgfSBpPTEgXHRleHRiZnsgdG8gfSBcZ2FtbWEgXHRleHRiZnsgZG99ICYmIFxcCiYgXHF1YWQgcV9pKHgpIFxsZWZ0YXJyb3cgTV9wKFx0ZXh0e3ByZWZpeH0gKyBbeF8xLCBcbGRvdHMsIHhfe2ktMX1dKSAmJiBcXAomIFxxdWFkIHhfaSBcc2ltIHFfaSh4KSAmJiBcXAomIFx0ZXh0YmZ7ZW5kIGZvcn0gJiYgXFwKJiBcdHJpYW5nbGVyaWdodCBcdGV4dHtSdW4gfSBNX3AgXHRleHR7IGluIHBhcmFsbGVsLn0gJiYgXFwKJiBwXzEoeCksIFxsZG90cywgcF97XGdhbW1hKzF9KHgpIFxsZWZ0YXJyb3cgTV9wKFx0ZXh0e3ByZWZpeH0pLCBcbGRvdHMsIE1fcChcdGV4dHtwcmVmaXh9ICsgW3hfMSwgXGxkb3RzLCB4X1xnYW1tYV0pICYmIFxcCiYgXHRyaWFuZ2xlcmlnaHQgXHRleHR7RGV0ZXJtaW5lIHRoZSBudW1iZXIgb2YgYWNjZXB0ZWQgZ3Vlc3NlcyB9IG4gJiYgXFwKJiByXzEgXHNpbSBVKDAsMSksIFxsZG90cywgcl9cZ2FtbWEgXHNpbSBVKDAsMSkgJiYgXFwKJiBuIFxsZWZ0YXJyb3cgXG1pbiBcbGVmdCggXHsgaSAtIDEgXG1pZCAxIFxsZXEgaSBcbGVxIFxnYW1tYSwgcl9pID4gXGZyYWN7cF9pKHgpfXtxX2koeCl9IFx9IFxjdXAgXHtcZ2FtbWFcfSBccmlnaHQpICYmIFxcCiYgXHRyaWFuZ2xlcmlnaHQgXHRleHR7QWRqdXN0IHRoZSBkaXN0cmlidXRpb24gZnJvbSB9IE1fcCBcdGV4dHsgaWYgbmVlZGVkLn0gJiYgXFwKJiBwJyh4KSBcbGVmdGFycm93IHBfe24rMX0oeCkgJiYgXFwKJiBcdGV4dGJme2lmIH0gbiA8IFxnYW1tYSBcdGV4dGJmeyB0aGVufSAmJiBcXAomIFxxdWFkIHAnKHgpIFxsZWZ0YXJyb3cgXG1hdGhybXtub3JtfShcbWF4KDAsIHBfe24rMX0oeCkgLSBxX3tuKzF9KHgpKSkgJiYgXFwKJiBcdGV4dGJme2VuZCBpZn0gJiYgXFwKJiBcdHJpYW5nbGVyaWdodCBcdGV4dHtSZXR1cm4gb25lIHRva2VuIGZyb20gfSBNX3AsIFx0ZXh0eyBhbmQgfSBuIFx0ZXh0eyB0b2tlbnMgZnJvbSB9IE1fcS4gJiYgXFwKJiB0IFxzaW0gcCcoeCkgJiYgXFwKJiBcdGV4dGJme3JldHVybiB9IFx0ZXh0e3ByZWZpeH0gKyBbeF8xLCBcbGRvdHMsIHhfbiwgdF0gJiYgXFwKJiAxIFxsZXEgaSBcbGVxIFxnYW1tYSAmJgpcZW5ke2ZsYWxpZ24qfQ" style="margin-bottom: 0px;"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-edit-from-here-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-map-pin-simple" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><span class="ml-1 border-0 border-l border-solid border-background-subtle pr-1" aria-hidden="true"></span><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" width="full" tabindex="0" ctxtmenu_counter="41" style="font-size: 123.4%; min-width: 26.96em; position: relative;"><mjx-math width="full" display="true" class="MJX-TEX" aria-hidden="true"><mjx-mtable data-width-includes-label="true" width="full" style="min-width: 26.96em;"><mjx-table style="width: 100%; min-width: 26.96em;"><mjx-itable width="full"><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; padding-right: 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em; padding-bottom: 0.15em;"><mjx-mtext class="mjx-b"><mjx-c class="mjx-c1D408 TEX-B"></mjx-c><mjx-c class="mjx-c1D427 TEX-B"></mjx-c><mjx-c class="mjx-c1D429 TEX-B"></mjx-c><mjx-c class="mjx-c1D42E TEX-B"></mjx-c><mjx-c class="mjx-c1D42D TEX-B"></mjx-c><mjx-c class="mjx-c1D42C TEX-B"></mjx-c><mjx-c class="mjx-c3A TEX-B"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mtext class="mjx-n" space="2"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0px; padding-right: 0px; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 0px; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c25B9"></mjx-c></mjx-mo><mjx-mtext class="mjx-n" space="3"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c76"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c79"></mjx-c><mjx-c class="mjx-c2E"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mtext class="mjx-b"><mjx-c class="mjx-c1D41F TEX-B"></mjx-c><mjx-c class="mjx-c1D428 TEX-B"></mjx-c><mjx-c class="mjx-c1D42B TEX-B"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mtext class="mjx-b"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c1D42D TEX-B"></mjx-c><mjx-c class="mjx-c1D428 TEX-B"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mtext class="mjx-b"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c1D41D TEX-B"></mjx-c><mjx-c class="mjx-c1D428 TEX-B"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mstyle><mjx-mspace style="width: 1em;"></mjx-mspace></mjx-mstyle><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.014em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mstyle><mjx-mspace style="width: 1em;"></mjx-mspace></mjx-mstyle><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.014em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mtext class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c><mjx-c class="mjx-c1D427 TEX-B"></mjx-c><mjx-c class="mjx-c1D41D TEX-B"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c1D41F TEX-B"></mjx-c><mjx-c class="mjx-c1D428 TEX-B"></mjx-c><mjx-c class="mjx-c1D42B TEX-B"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c25B9"></mjx-c></mjx-mo><mjx-mtext class="mjx-n" space="3"><mjx-c class="mjx-c52"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c2E"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c25B9"></mjx-c></mjx-mo><mjx-mtext class="mjx-n" space="3"><mjx-c class="mjx-c44"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c68"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c62"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c67"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mo><mjx-mrow space="2"><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2223"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.014em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c222A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c25B9"></mjx-c></mjx-mo><mjx-mtext class="mjx-n" space="3"><mjx-c class="mjx-c41"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c6A"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c68"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c62"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c2E"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em;"><mjx-mo class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mtext class="mjx-b"><mjx-c class="mjx-c1D422 TEX-B"></mjx-c><mjx-c class="mjx-c1D41F TEX-B"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mtext class="mjx-b"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c1D42D TEX-B"></mjx-c><mjx-c class="mjx-c1D421 TEX-B"></mjx-c><mjx-c class="mjx-c1D41E TEX-B"></mjx-c><mjx-c class="mjx-c1D427 TEX-B"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mstyle><mjx-mspace style="width: 1em;"></mjx-mspace></mjx-mstyle><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em;"><mjx-mo class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6D"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.014em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mtext class="mjx-b"><mjx-c class="mjx-c1D41E TEX-B"></mjx-c><mjx-c class="mjx-c1D427 TEX-B"></mjx-c><mjx-c class="mjx-c1D41D TEX-B"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c1D422 TEX-B"></mjx-c><mjx-c class="mjx-c1D41F TEX-B"></mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mi class="mjx-n"></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c25B9"></mjx-c></mjx-mo><mjx-mtext class="mjx-n" space="3"><mjx-c class="mjx-c52"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6B"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mtext class="mjx-n" space="2"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mtext class="mjx-n"><mjx-c class="mjx-cA0"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6B"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c20"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.081em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em;"><mjx-mo class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding: 0.15em 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em;"><mjx-mtext class="mjx-b"><mjx-c class="mjx-c1D42B TEX-B"></mjx-c><mjx-c class="mjx-c1D41E TEX-B"></mjx-c><mjx-c class="mjx-c1D42D TEX-B"></mjx-c><mjx-c class="mjx-c1D42E TEX-B"></mjx-c><mjx-c class="mjx-c1D42B TEX-B"></mjx-c><mjx-c class="mjx-c1D427 TEX-B"></mjx-c><mjx-c class="mjx-cA0"></mjx-c></mjx-mtext><mjx-mtext class="mjx-n"><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c66"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding: 0.15em 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding: 0.15em 0px; width: 0px; max-width: 0px; min-width: 0px;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em; padding-bottom: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: right; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; padding-right: 0px; width: 26.96em; max-width: 26.96em; min-width: 26.96em; padding-top: 0.15em;"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="padding-left: 0px; padding-right: 0px; padding-top: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: right; padding-left: 0px; padding-right: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style="text-align: left; padding-left: 0px; width: 0px; max-width: 0px; min-width: 0px; padding-top: 0.15em;"><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable width="100%" displaystyle="true" columnalign="right left center right left" columnspacing="0em" columnwidth="auto auto fit auto auto" rowspacing="3pt" data-width-includes-label="true"><mtr><mtd></mtd><mtd><mtext mathvariant="bold">Inputs:&nbsp;</mtext><msub><mi>M</mi><mi>p</mi></msub><mo>,</mo><msub><mi>M</mi><mi>q</mi></msub><mo>,</mo><mtext>&nbsp;prefix</mtext></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>▹</mo><mtext>Sample&nbsp;</mtext><mi>γ</mi><mtext>&nbsp;guesses&nbsp;</mtext><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mi>γ</mi></msub><mtext>&nbsp;from&nbsp;</mtext><msub><mi>M</mi><mi>q</mi></msub><mtext>&nbsp;autoregressively.</mtext></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mtext mathvariant="bold">for&nbsp;</mtext><mi>i</mi><mo>=</mo><mn>1</mn><mtext mathvariant="bold">&nbsp;to&nbsp;</mtext><mi>γ</mi><mtext mathvariant="bold">&nbsp;do</mtext></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><msub><mi>M</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mtext>prefix</mtext><mo>+</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><msub><mi>x</mi><mi>i</mi></msub><mo>∼</mo><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mtext mathvariant="bold">end for</mtext></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>▹</mo><mtext>Run&nbsp;</mtext><msub><mi>M</mi><mi>p</mi></msub><mtext>&nbsp;in parallel.</mtext></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>p</mi><mrow data-mjx-texclass="ORD"><mi>γ</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><msub><mi>M</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mtext>prefix</mtext><mo stretchy="false">)</mo><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>M</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mtext>prefix</mtext><mo>+</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mi>γ</mi></msub><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>▹</mo><mtext>Determine the number of accepted guesses&nbsp;</mtext><mi>n</mi></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><msub><mi>r</mi><mn>1</mn></msub><mo>∼</mo><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>r</mi><mi>γ</mi></msub><mo>∼</mo><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi>n</mi><mo stretchy="false">←</mo><mo data-mjx-texclass="OP" movablelimits="true">min</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mo fence="false" stretchy="false">{</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>∣</mo><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>γ</mi><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo>&gt;</mo><mfrac><mrow><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="false">}</mo><mo>∪</mo><mo fence="false" stretchy="false">{</mo><mi>γ</mi><mo fence="false" stretchy="false">}</mo><mo data-mjx-texclass="CLOSE">)</mo></mrow></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>▹</mo><mtext>Adjust the distribution from&nbsp;</mtext><msub><mi>M</mi><mi>p</mi></msub><mtext>&nbsp;if needed.</mtext></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><msup><mi>p</mi><mo data-mjx-alternate="1">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><msub><mi>p</mi><mrow data-mjx-texclass="ORD"><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mtext mathvariant="bold">if&nbsp;</mtext><mi>n</mi><mo>&lt;</mo><mi>γ</mi><mtext mathvariant="bold">&nbsp;then</mtext></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><msup><mi>p</mi><mo data-mjx-alternate="1">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mrow data-mjx-texclass="ORD"><mi data-mjx-auto-op="false">norm</mi></mrow><mo stretchy="false">(</mo><mo data-mjx-texclass="OP" movablelimits="true">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msub><mi>p</mi><mrow data-mjx-texclass="ORD"><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>q</mi><mrow data-mjx-texclass="ORD"><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mtext mathvariant="bold">end if</mtext></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>▹</mo><mtext>Return one token from&nbsp;</mtext><msub><mi>M</mi><mi>p</mi></msub><mo>,</mo><mtext>&nbsp;and&nbsp;</mtext><mi>n</mi><mtext>&nbsp;tokens from&nbsp;</mtext><msub><mi>M</mi><mi>q</mi></msub><mo>.</mo></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi>t</mi><mo>∼</mo><msup><mi>p</mi><mo data-mjx-alternate="1">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mtext mathvariant="bold">return&nbsp;</mtext><mtext>prefix</mtext><mo>+</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo>,</mo><mi>t</mi><mo stretchy="false">]</mo></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>γ</mi></mtd><mtd></mtd><mtd></mtd><mtd></mtd></mtr></mtable></math></mjx-assistive-mml></mjx-container></span></p>
</div><hr><h2 id="The-Need-for-Long-Context-Speculative-Decoding" data-id="The-Need-for-Long-Context-Speculative-Decoding" style=""><span>The Need for Long-Context Speculative Decoding</span></h2><h3 id="Dual-Memory-Bottlenecks-in-LLMs-Model-Parameters-and-KV-Cache" data-id="Dual-Memory-Bottlenecks-in-LLMs-Model-Parameters-and-KV-Cache" style=""><span>Dual Memory Bottlenecks in LLMs: Model Parameters and KV Cache</span></h3><p><span>We found an interesting observation while researching speculative decoding to improve the efficiency of LLM decoding. We conducted experiments under various conditions to measure the speedup using Llama-2-7b-chat as the target model and Llama-68M as the draft model. As we increased the number of generated tokens from 128 to 4096, which is the maximum sequence length that Llama-2-7b-chat can handle, we observed that the effectiveness of speculative decoding diminished as the number of generated tokens grew.</span></p><div style="text-align: center;">
  <span class="image-toolbar-wrapper inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" style="width: 600px;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="https://hackmd.io/_uploads/S1J-5bLzxl.png" alt="speed_up_context" width="600" class="offline-handled error-handled image-toolbar-handled" style="width: 100%; height: 100%; max-width: 100%; max-height: 100%;"></span>
</div><div style="text-align: left; font-size: 0.9em; color: gray; margin: 0 auto 20px;">
  Figure 2. Comparison of token generation speeds between speculative decoding and greedy decoding across varying numbers of generated tokens. evaluated on a single RTX-3090 GPU.
</div><p><span>The bar chart shows tokens per second for both methods, while the line plot illustrates the speedup ratio (speculative over greedy). The data indicates that speculative decoding provides notable speedup for shorter generation lengths, but its advantage diminishes as the number of generated tokens increases. This decline in effectiveness is mainly caused by the growing cache size. As the cache gets larger, memory use and bandwidth demands increase, adding overhead and reducing the speedup from speculative decoding. Motivated by this issue, we focused on the performance decline of speculative decoding in long context scenarios and explored relevant studies.</span></p><div style="text-align: center;">
  <span class="image-toolbar-wrapper inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" style="width: 600px;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="https://hackmd.io/_uploads/rJBUFZIGle.png" alt="model_context_cache" width="600" class="offline-handled error-handled image-toolbar-handled" style="width: 100%; height: 100%; max-width: 100%; max-height: 100%;"></span>
</div><div style="text-align: left; font-size: 0.9em; color: gray; margin: 0 auto 20px;">
  Figure 3. Memory usage breakdown of KV Cache and model weights across varying context lengths.
</div><h2 id="Understanding-KV-Cache-Behavior-for-Efficient-Long-Context-Decoding" data-id="Understanding-KV-Cache-Behavior-for-Efficient-Long-Context-Decoding" style=""><span>Understanding KV-Cache Behavior for Efficient Long-Context Decoding</span></h2><h3 id="Attention-Sparsity" data-id="Attention-Sparsity" style=""><span>Attention Sparsity</span></h3><p><span>During inference in large language models (LLMs), it has been observed that only a small subset of tokens receive high attention scores, while most tokens receive very low scores. Over 95% of the attention matrix is effectively sparse, which is a well-established finding</span><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup><span>. In addition, many attention heads tend to focus heavily on specific tokens—a phenomenon known as attention sinks. This behavior is consistently observed across various models and layers, with many heads exhibiting similar sparsity patterns</span><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup><span>.</span></p><p><span>These observations offer valuable insight into how the KV-Cache can be managed more efficiently. Rather than being a superficial characteristic, attention sparsity presents a meaningful opportunity for optimization: by evicting unimportant KV entries and retaining only the most relevant ones, both memory usage and computational cost can be significantly reduced.</span></p><h3 id="Leveraging-Local-Redundancy-in-KV-Cache-Design" data-id="Leveraging-Local-Redundancy-in-KV-Cache-Design" style=""><span>Leveraging Local Redundancy in KV-Cache Design</span></h3><p><span>The KV-Cache can be divided into smaller chunks, allowing each to be selectively accessed through a retrieval-based approach with little to no impact on performance</span><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup><span>. By fetching only the relevant information needed for attention computation, this method helps reduce memory usage and avoid unnecessary computation. Although performance may vary depending on chunk size and retrieval strategy, this approach is widely seen as an effective and practical way to support efficient inference.</span></p><h2 id="-HiTree-Hierarchical-Speculation-via-Tree-Based-Drafting" data-id="-HiTree-Hierarchical-Speculation-via-Tree-Based-Drafting" style=""><img class="emoji offline-handled error-handled" alt=":deciduous_tree:" src="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/images/basic/deciduous_tree.png"><span> HiTree: Hierarchical Speculation via Tree-Based Drafting</span></h2><p><span>While exploring ways to improve speculative decoding in long-context scenarios, we came across the </span><a href="https://github.com/Infini-AI-Lab/TriForce" target="_blank" rel="noopener"><span>triforce framework</span></a><span>. Although it introduced an efficient cache management strategy, it did not incorporate a tree-based drafting mechanism. This led us to investigate whether integrating a tree structure into the Triformer approach could further enhance performance, which became the starting point of our experiments.</span></p><h3 id="Hierarchical-Speculative-Decoding" data-id="Hierarchical-Speculative-Decoding" style=""><span>Hierarchical Speculative Decoding</span></h3><p><span>Triforce is a hierarchical speculative decoding framework designed to improve memory efficiency and computational performance during inference in large language models (LLMs), particularly in long-context scenarios.</span></p><p><span>The system adopts a hierarchical decoding architecture, where a smaller model first drafts candidate tokens, and the full target model verifies these candidates. One of the core components of Triforce is its KV Retrieval mechanism, which partitions the KV-Cache into smaller chunks and maintains lightweight summary information for each. This design reduces unnecessary memory access, thereby enabling more efficient use of computational and storage resources.</span></p><h3 id="HiTree-Design-Overview" data-id="HiTree-Design-Overview" style=""><span>HiTree Design Overview</span></h3><p><span>Tree-based speculative decoding is motivated by the observation that strategically leveraging top-ranked predictions can enable the generation of multiple tokens per decoding step</span><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup><span>. Recent studies have explored similar approaches by incorporating tree-attention mechanisms, and in our work, we focus on integrating a structured tree with a fixed pattern, rather than a dynamically expanding one during inference. The design overview shown in Figure.</span><a href="#design-overview"><span>4</span></a><span>. presents a retrieval-based speculative decoding framework where decoding is performed hierarchically. We introduce a tree-structured expansion of candidate tokens between the smaller draft model and the draft model, aiming to increase the expected length of accepted sequences in each decoding step.</span></p><p><a id="design-overview" target="_blank" rel="noopener"></a></p><div style="text-align: center;">
  <span class="image-toolbar-wrapper inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" style="width: 600px;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="https://hackmd.io/_uploads/HkpTWaLzge.png" alt="efficient_ML_proposal" width="600" class="offline-handled error-handled image-toolbar-handled" style="width: 100%; height: 100%; max-width: 100%; max-height: 100%;"></span>
</div><div style="text-align: center; font-size: 0.9em; color: gray; margin: 0 auto 20px;">
  Figure 4. Design overview of HiTree
</div><p><a id="tree_application" target="_blank" rel="noopener"></a></p><div style="text-align: center;">
  <span class="image-toolbar-wrapper inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" style="width: 600px;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="https://hackmd.io/_uploads/B165eIvfex.png" alt="efficient_ML_proposal" width="600" class="offline-handled error-handled image-toolbar-handled" style="width: 100%; height: 100%; max-width: 100%; max-height: 100%;"></span>
</div><div style="text-align: center; font-size: 0.9em; color: gray; margin: 0 auto 20px;">
  Figure 5. Tree architecture adoption between the draft model and retrieval model
</div><h2 id="-How-Fast-Can-a-Llama-Spit" data-id="-How-Fast-Can-a-Llama-Spit" style=""><img class="emoji offline-handled error-handled" alt=":llama:" src="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/images/basic/llama.png"><span> How Fast Can a Llama Spit?</span></h2><h3 id="Experimental-Settings" data-id="Experimental-Settings" style=""><span>Experimental Settings</span></h3><p><span>Our experiments were conducted based on the Triforce framework, as previously described. To ensure a fair comparison with Triforce, we adopted most of the original experimental settings. We used Llama2 and LWM models with a 128K context window as our target models</span><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup><span>.</span></p><p><span>In this setup, we employed a 4K retrieval cache as an intermediate draft cache,</span>
<span>and used the JackFram/Llama68M (JF68M) model (Miao et al., 2023) as the initial draft model. Due to the resource constraints associated with long-context experiments,</span>
<span>we conducted our experiments under an offloading setting. Specifically, we maximized GPU memory utilization by filling it as much as possible, then offloaded the remaining KV cache to the CPU, while keeping the model weights residing on the GPU.</span></p><p><span>Evaluation was performed on the PG-19 dataset using 100 test examples,</span>
<span>with a target generation length of 256 tokens,</span>
<span>and we measured speedup as the primary performance metric.</span></p><h3 id="Main-Results" data-id="Main-Results" style=""><span>Main Results</span></h3><p><a id="overall_result" target="_blank" rel="noopener"></a></p><div style="text-align: center;">
  <span class="image-toolbar-wrapper inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" style="width: 700px;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="https://hackmd.io/_uploads/rJaWPLDfge.png" alt="overall_result" width="700" class="offline-handled error-handled image-toolbar-handled" style="width: 100%; height: 100%; max-width: 100%; max-height: 100%;"></span>
</div><div style="text-align: left; font-size: 0.9em; color: gray; margin: 0 auto 20px;">
  Figure 6. Comparison of the acceptance ratio and throughput between the non-tree and tree architecture.
</div><p><span>We conducted experiments across various combinations of </span><span class="mathjax code-block-wrapper code-block-toolbar-handled" data-raw-code="XGdhbW1hMQ" style="margin-bottom: 0px; display: inline-block;"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-edit-from-here-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-map-pin-simple" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><span class="ml-1 border-0 border-l border-solid border-background-subtle pr-1" aria-hidden="true"></span><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="35" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span> and </span><span class="mathjax code-block-wrapper code-block-toolbar-handled" data-raw-code="XGdhbW1hMg" style="margin-bottom: 0px; display: inline-block;"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-edit-from-here-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-map-pin-simple" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><span class="ml-1 border-0 border-l border-solid border-background-subtle pr-1" aria-hidden="true"></span><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="36" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mn>2</mn></math></mjx-assistive-mml></mjx-container></span><span>.</span>
<span>Specifically, we used </span><span class="mathjax code-block-wrapper code-block-toolbar-handled" data-raw-code="XGdhbW1hMQ" style="margin-bottom: 0px; display: inline-block;"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-edit-from-here-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-map-pin-simple" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><span class="ml-1 border-0 border-l border-solid border-background-subtle pr-1" aria-hidden="true"></span><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="37" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span> values of 2, 4, and 6, and </span><span class="mathjax code-block-wrapper code-block-toolbar-handled" data-raw-code="XGdhbW1hMg" style="margin-bottom: 0px; display: inline-block;"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-edit-from-here-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-map-pin-simple" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><span class="ml-1 border-0 border-l border-solid border-background-subtle pr-1" aria-hidden="true"></span><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="38" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mn>2</mn></math></mjx-assistive-mml></mjx-container></span><span> values of 6 and 12, following the configuration adopted in Triforce. In our setup, the depth of the tree was set equal to </span><span class="mathjax code-block-wrapper code-block-toolbar-handled" data-raw-code="XGdhbW1hMQ" style="margin-bottom: 0px; display: inline-block;"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-edit-from-here-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-map-pin-simple" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><span class="ml-1 border-0 border-l border-solid border-background-subtle pr-1" aria-hidden="true"></span><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="39" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span>, and we employed a fixed binary tree structure to perform tree-based speculative decoding.</span>
<span>This design allowed us to simplify the implementation while maintaining consistency with the hierarchical decoding framework.</span></p><p><span>We firstly conducted an experiment about the effect of the tree-based architecture in the hierarchy. Figure.</span><a href="#overall_result"><span>6</span></a><span> illustrates the acceptance rate and throughput within the hierarchical structure, specifically between the target model and the retrieval-draft model, as well as between the retrieval model and the draft model.</span>
<span>Since tree-based drafting is applied only between the draft and retrieval models, the behavior between the target and retrieval models remains consistent across both tree-based and non-tree settings. In contrast, between the retrieval and draft models, we observed a significant improvement in both acceptance rate and throughput, highlighting the effectiveness of the tree-based drafting strategy in this stage.</span></p><p><span>As shown in Figure.</span><a href="#speed_up_hitree"><span>7</span></a><span>, under the configuration of γ₁ = 4 and γ₂ = 12, HiTree achieved a 17.7% speedup over Triforce and demonstrated 1.72× faster performance than the autoregressive (AR) baseline.</span>
<span>In contrast, in the setting where γ₁ = 4 and γ₂ = 6, where Triforce's speedup was relatively strong, HiTree’s advantage was less evident.</span></p><p><span>Across all experimental settings, we observed that HiTree, which employs tree-based hierarchical speculative decoding, consistently achieved higher speedup compared to Triforce.</span></p><p><a id="speed_up_hitree" target="_blank" rel="noopener"></a></p><div style="text-align: center;">
  <span class="image-toolbar-wrapper inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" style="width: 700px;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="https://hackmd.io/_uploads/rymQiSDGll.png" alt="speed_up_hitree" width="700" class="offline-handled error-handled image-toolbar-handled" style="width: 100%; height: 100%; max-width: 100%; max-height: 100%;"></span>
</div><div style="text-align: left; font-size: 0.9em; color: gray; margin: 0 auto 20px;">
  Figure 7. Comparison of speedup between Triforce and HiTree under various settings.
A speedup value of 1 corresponds to the decoding speed of the autoregressive (AR) baseline.
</div><p><span>As shown in Figure.</span><a href="#overall_result"><span>6</span></a><span>, we observed a significant drop in the acceptance rate for Triforce as γ increased. This is perhaps unsurprising, as Triforce performs autoregressive decoding based on tokens generated by a smaller draft model.</span></p><p><span>In contrast, HiTree maintained a more stable acceptance rate even as γ₁ increased, suggesting that the tree structure provides greater robustness during speculative verification.</span></p><p><a id="acceptance" target="_blank" rel="noopener"></a></p><div style="text-align: center;">
  <span class="image-toolbar-wrapper inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" style="width: 700px;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="https://hackmd.io/_uploads/rJCbZUvzee.png" alt="acceptance" width="700" class="offline-handled error-handled image-toolbar-handled" style="width: 100%; height: 100%; max-width: 100%; max-height: 100%;"></span>
</div><div style="text-align: center; font-size: 0.9em; color: gray; margin: 0 auto 20px;">
  Figure 8. Ablation for tree size that depends on the number of branches
</div><p><span>We additionally conducted an ablation study by varying the number of branches per node to analyze the effect of different tree structures on performance.</span></p><p><span>Thanks to the parallel nature of tree construction, we observed minimal increase in generation latency across different branching factors. Notably, setting the branch size to 3 resulted in a meaningful improvement in acceptance rate. This indicates that, within a reasonable memory budget, increasing tree size can be an effective strategy.</span></p><p><span>However, the memory required for KV cache grows exponentially with the number of branches, while the corresponding gains in acceptance rate diminish. As a result, increasing the branch factor beyond 4 is likely to be inefficient due to the unfavorable trade-off between memory usage and performance improvement.</span></p><h3 id="Limitation-amp-Future-Work" data-id="Limitation-amp-Future-Work" style=""><span>Limitation &amp; Future Work</span></h3><p><span>In this study, we conducted our experiments using a fixed binary tree structure.</span>
<span>This approach offers the advantage of simplicity in implementation and clarity in inference flow design.</span>
<span>However, it also has limitations, as it does not guarantee optimal candidate exploration across diverse scenarios.</span></p><p><span>Future work could extend the HiTree framework by dynamically constructing the tree and adapting its structure based on token distributions.</span>
<span>Such an approach would enable more flexible and efficient candidate branching tailored to the context, and has the potential to further maximize acceptance rate and reduce latency.</span></p><h2 id="Conclusion" data-id="Conclusion" style=""><span>Conclusion</span></h2><p><span>In this project, we propose HiTree, a novel LLM decoding framework that integrates hierarchical speculative decoding with tree-based drafting. We observed that existing speculative decoding methods often struggle with long-context generation. By incorporating a tree-based drafting strategy between the draft and target models, HiTree achieves up to 3.23× higher acceptance rates compared to using hierarchical speculation alone, ultimately leading to a 17% reduction in latency.</span></p><hr class="footnotes-sep"><section class="footnotes">
<ol class="footnotes-list" style="padding-left: 2em;">
<li id="fn1" class="footnote-item"><p><span>Patel, Pratyush, et al. "Splitwise: Efficient generative llm inference using phase splitting." 2024 ACM/IEEE 51st Annual International Symposium on Computer Architecture (ISCA). IEEE, 2024. </span><a href="https://arxiv.org/pdf/2311.18677" target="_blank" rel="noopener"><span>[pdf]</span></a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p><span>Leviathan, Yaniv, Matan Kalman, and Yossi Matias. "Fast inference from transformers via speculative decoding." International Conference on Machine Learning. PMLR, 2023. </span><a href="https://arxiv.org/pdf/2211.17192" target="_blank" rel="noopener"><span>[pdf]</span></a> <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn3" class="footnote-item"><p><span>Zhang, Zhenyu, et al. "H2o: Heavy-hitter oracle for efficient generative inference of large language models." Advances in Neural Information Processing Systems 36 (2023): 34661-34710. </span><a href="https://arxiv.org/pdf/2306.14048" target="_blank" rel="noopener"><span>[pdf]</span></a> <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn4" class="footnote-item"><p><span>Xiao, Guangxuan, et al. "Efficient streaming language models with attention sinks." arXiv preprint arXiv:2309.17453 (2023). </span><a href="https://arxiv.org/pdf/2309.17453" target="_blank" rel="noopener"><span>[pdf]</span></a> <a href="#fnref4" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn5" class="footnote-item"><p><span>Sun, Hanshi, et al. "Triforce: Lossless acceleration of long sequence generation with hierarchical speculative decoding." arXiv preprint arXiv:2404.11912 (2024). </span><a href="https://arxiv.org/pdf/2404.11912" target="_blank" rel="noopener"><span>[pdf]</span></a> <a href="#fnref5" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn6" class="footnote-item"><p><span>Cai, Tianle, et al. "Medusa: Simple llm inference acceleration framework with multiple decoding heads." arXiv preprint arXiv:2401.10774 (2024). </span><a href="https://arxiv.org/pdf/2401.10774" target="_blank" rel="noopener"><span>[pdf]</span></a> <a href="#fnref6" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn7" class="footnote-item"><p><span>Miao, Xupeng, et al. "Specinfer: Accelerating large language model serving with tree-based speculative inference and verification." Proceedings of the 29th ACM International Conference on Architectural Support for Programming Languages and Operating Systems, Volume 3. 2024. </span><a href="https://arxiv.org/pdf/2305.09781" target="_blank" rel="noopener"><span>[pdf]</span></a> <a href="#fnref7" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn8" class="footnote-item"><p><span>Li, Yuhui, et al. "Eagle: Speculative sampling requires rethinking feature uncertainty." arXiv preprint arXiv:2401.15077 (2024). </span><a href="https://arxiv.org/pdf/2401.15077" target="_blank" rel="noopener"><span>[pdf]</span></a> <a href="#fnref8" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn9" class="footnote-item"><p><span>Peng, Bowen, et al. "Yarn: Efficient context window extension of large language models." arXiv preprint arXiv:2309.00071 (2023). </span><a href="https://arxiv.org/pdf/2309.00071" target="_blank" rel="noopener"><span>[pdf]</span></a> <a href="#fnref9" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section></div>